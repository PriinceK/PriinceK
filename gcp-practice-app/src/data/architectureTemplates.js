import { GCP_SERVICES } from './gcpServices'

function svc(id) {
  return GCP_SERVICES.find((s) => s.id === id) || { id, name: id, category: 'compute', description: '' }
}

export const ARCHITECTURE_TEMPLATES = [
  {
    id: 'three-tier-web',
    name: 'Three-Tier Web Application',
    description: 'Classic web architecture with load-balanced frontend, managed backend, and Cloud SQL database. Ideal for traditional web apps migrated to GCP.',
    difficulty: 'Beginner',
    tags: ['web', 'load balancing', 'sql', 'compute'],
    preview: { nodeCount: 7, connectionCount: 6 },
    nodes: [
      { id: 'n1', service: svc('cloud-cdn'), x: 360, y: 48 },
      { id: 'n2', service: svc('cloud-load-balancing'), x: 360, y: 168 },
      { id: 'n3', service: svc('compute-engine'), x: 168, y: 312 },
      { id: 'n4', service: svc('compute-engine'), x: 360, y: 312 },
      { id: 'n5', service: svc('compute-engine'), x: 552, y: 312 },
      { id: 'n6', service: svc('cloud-sql'), x: 264, y: 480 },
      { id: 'n7', service: svc('memorystore'), x: 456, y: 480 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n2', label: 'HTTPS' },
      { id: 'c2', from: 'n2', to: 'n3', label: '' },
      { id: 'c3', from: 'n2', to: 'n4', label: '' },
      { id: 'c4', from: 'n2', to: 'n5', label: '' },
      { id: 'c5', from: 'n4', to: 'n6', label: 'SQL' },
      { id: 'c6', from: 'n4', to: 'n7', label: 'Redis' },
    ],
    zones: [
      { id: 'z1', x: 320, y: 24, width: 200, height: 88, label: 'Edge / CDN', color: '#ea4335' },
      { id: 'z2', x: 320, y: 144, width: 200, height: 88, label: 'Load Balancer', color: '#ea4335' },
      { id: 'z3', x: 120, y: 280, width: 520, height: 100, label: 'Compute Tier (MIG)', color: '#4285f4' },
      { id: 'z4', x: 200, y: 440, width: 360, height: 100, label: 'Data Tier', color: '#34a853' },
    ],
    annotations: [
      { id: 'a1', x: 600, y: 60, text: 'Cloud CDN caches static\nassets at Google edge POPs' },
      { id: 'a2', x: 600, y: 490, text: 'Cloud SQL HA with\nautomatic failover' },
    ],
    learningNotes: [
      'Use Managed Instance Groups (MIGs) for auto-scaling and autohealing the compute tier.',
      'Cloud SQL should use Private IP with a VPC Peering connection for security.',
      'Memorystore (Redis) reduces database load by caching session data and frequent queries.',
      'Enable Cloud CDN on the load balancer backend for static content acceleration.',
      'Consider Cloud Armor on the load balancer for DDoS and WAF protection.',
    ],
  },
  {
    id: 'streaming-data-pipeline',
    name: 'Real-Time Streaming Pipeline',
    description: 'Event ingestion with Pub/Sub, Dataflow stream processing, and BigQuery for analytics. The standard GCP streaming architecture.',
    difficulty: 'Intermediate',
    tags: ['streaming', 'analytics', 'pubsub', 'bigquery'],
    preview: { nodeCount: 7, connectionCount: 6 },
    nodes: [
      { id: 'n1', service: svc('pub-sub'), x: 120, y: 192 },
      { id: 'n2', service: svc('dataflow'), x: 360, y: 192 },
      { id: 'n3', service: svc('bigquery'), x: 600, y: 120 },
      { id: 'n4', service: svc('cloud-storage'), x: 600, y: 288 },
      { id: 'n5', service: svc('cloud-functions'), x: 120, y: 48 },
      { id: 'n6', service: svc('cloud-monitoring'), x: 360, y: 384 },
      { id: 'n7', service: svc('vertex-ai'), x: 840, y: 120 },
    ],
    connections: [
      { id: 'c1', from: 'n5', to: 'n1', label: 'publish' },
      { id: 'c2', from: 'n1', to: 'n2', label: 'subscribe' },
      { id: 'c3', from: 'n2', to: 'n3', label: 'streaming insert' },
      { id: 'c4', from: 'n2', to: 'n4', label: 'dead-letter / raw' },
      { id: 'c5', from: 'n2', to: 'n6', label: 'metrics' },
      { id: 'c6', from: 'n3', to: 'n7', label: 'BQML' },
    ],
    zones: [
      { id: 'z1', x: 72, y: 24, width: 200, height: 280, label: 'Ingestion', color: '#9c27b0' },
      { id: 'z2', x: 300, y: 150, width: 180, height: 120, label: 'Processing', color: '#9c27b0' },
      { id: 'z3', x: 540, y: 72, width: 180, height: 280, label: 'Storage & Analytics', color: '#34a853' },
      { id: 'z4', x: 780, y: 72, width: 180, height: 120, label: 'ML / Insights', color: '#ff6d00' },
    ],
    annotations: [
      { id: 'a1', x: 120, y: 360, text: 'IoT devices, apps, or\nCloud Functions publish\nevents to Pub/Sub topics' },
      { id: 'a2', x: 600, y: 390, text: 'Failed records go to GCS\ndead-letter bucket for\nreprocessing' },
    ],
    learningNotes: [
      'Pub/Sub decouples producers from consumers — publishers don\'t need to know about subscribers.',
      'Dataflow (Apache Beam) handles both batch and stream with the same pipeline code.',
      'Use BigQuery streaming inserts for real-time analytics dashboards.',
      'Dead-letter patterns in Dataflow send failed records to Cloud Storage for later reprocessing.',
      'BigQuery ML lets you train ML models directly on your warehouse data using SQL.',
    ],
  },
  {
    id: 'microservices-gke',
    name: 'Microservices on GKE',
    description: 'Container-based microservices with GKE Autopilot, internal load balancing, Cloud SQL, and CI/CD with Cloud Build.',
    difficulty: 'Advanced',
    tags: ['kubernetes', 'containers', 'microservices', 'ci/cd'],
    preview: { nodeCount: 9, connectionCount: 9 },
    nodes: [
      { id: 'n1', service: svc('cloud-load-balancing'), x: 360, y: 48 },
      { id: 'n2', service: svc('gke'), x: 168, y: 216 },
      { id: 'n3', service: svc('gke'), x: 360, y: 216 },
      { id: 'n4', service: svc('gke'), x: 552, y: 216 },
      { id: 'n5', service: svc('cloud-sql'), x: 168, y: 408 },
      { id: 'n6', service: svc('memorystore'), x: 360, y: 408 },
      { id: 'n7', service: svc('pub-sub'), x: 552, y: 408 },
      { id: 'n8', service: svc('cloud-build'), x: 792, y: 120 },
      { id: 'n9', service: svc('artifact-registry'), x: 792, y: 288 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n2', label: '/api/users' },
      { id: 'c2', from: 'n1', to: 'n3', label: '/api/orders' },
      { id: 'c3', from: 'n1', to: 'n4', label: '/api/inventory' },
      { id: 'c4', from: 'n2', to: 'n5', label: 'SQL proxy' },
      { id: 'c5', from: 'n3', to: 'n6', label: 'cache' },
      { id: 'c6', from: 'n4', to: 'n7', label: 'events' },
      { id: 'c7', from: 'n3', to: 'n7', label: 'order events' },
      { id: 'c8', from: 'n8', to: 'n9', label: 'push image' },
      { id: 'c9', from: 'n9', to: 'n3', label: 'pull image' },
    ],
    zones: [
      { id: 'z1', x: 312, y: 24, width: 200, height: 80, label: 'Ingress', color: '#ea4335' },
      { id: 'z2', x: 120, y: 180, width: 520, height: 100, label: 'GKE Autopilot Cluster', color: '#4285f4' },
      { id: 'z3', x: 120, y: 370, width: 520, height: 100, label: 'Backing Services', color: '#34a853' },
      { id: 'z4', x: 744, y: 80, width: 180, height: 270, label: 'CI/CD Pipeline', color: '#00bcd4' },
    ],
    annotations: [
      { id: 'a1', x: 120, y: 120, text: 'Each microservice runs as\na separate GKE Deployment\nwith its own Service' },
      { id: 'a2', x: 744, y: 380, text: 'Cloud Build triggers on\ngit push → builds container\n→ pushes to Artifact Registry\n→ deploys to GKE' },
    ],
    learningNotes: [
      'GKE Autopilot manages nodes automatically — you only define pod resources.',
      'Use Workload Identity (not service account keys) for pods to access GCP services.',
      'Cloud SQL Auth Proxy runs as a sidecar container for secure database access.',
      'Pub/Sub enables async communication between microservices (event-driven).',
      'Artifact Registry replaces Container Registry with better IAM and multi-format support.',
      'Cloud Build can be triggered by GitHub webhooks for fully automated CI/CD.',
    ],
  },
  {
    id: 'serverless-api',
    name: 'Serverless REST API',
    description: 'Fully serverless API with Cloud Run, Firestore, Secret Manager, and Cloud Endpoints. Zero infrastructure to manage.',
    difficulty: 'Beginner',
    tags: ['serverless', 'api', 'cloud-run', 'firestore'],
    preview: { nodeCount: 6, connectionCount: 5 },
    nodes: [
      { id: 'n1', service: svc('cloud-load-balancing'), x: 312, y: 48 },
      { id: 'n2', service: svc('cloud-run'), x: 312, y: 216 },
      { id: 'n3', service: svc('firestore'), x: 120, y: 408 },
      { id: 'n4', service: svc('secret-manager'), x: 504, y: 216 },
      { id: 'n5', service: svc('cloud-storage'), x: 312, y: 408 },
      { id: 'n6', service: svc('cloud-build'), x: 504, y: 408 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n2', label: 'HTTPS' },
      { id: 'c2', from: 'n2', to: 'n3', label: 'read/write' },
      { id: 'c3', from: 'n2', to: 'n4', label: 'fetch secrets' },
      { id: 'c4', from: 'n2', to: 'n5', label: 'file uploads' },
      { id: 'c5', from: 'n6', to: 'n2', label: 'deploy' },
    ],
    zones: [
      { id: 'z1', x: 264, y: 24, width: 200, height: 80, label: 'Edge + LB', color: '#ea4335' },
      { id: 'z2', x: 264, y: 176, width: 300, height: 100, label: 'Serverless Compute', color: '#e91e63' },
      { id: 'z3', x: 72, y: 368, width: 520, height: 100, label: 'Data + DevOps', color: '#34a853' },
    ],
    annotations: [
      { id: 'a1', x: 552, y: 48, text: 'Cloud Armor for\nDDoS + WAF protection' },
      { id: 'a2', x: 552, y: 120, text: 'Cloud Run scales to zero\nwhen idle — zero cost\nwhen no traffic' },
    ],
    learningNotes: [
      'Cloud Run scales to zero — you pay nothing when there\'s no traffic.',
      'Use Secret Manager (not env vars) for API keys, DB credentials, and tokens.',
      'Firestore in Native mode is ideal for mobile/web backends with real-time sync.',
      'Cloud Build + Cloud Run = fully serverless CI/CD with no infrastructure to manage.',
      'Set concurrency > 1 on Cloud Run to handle multiple requests per instance efficiently.',
    ],
  },
  {
    id: 'hybrid-cloud',
    name: 'Hybrid Cloud with VPN',
    description: 'Connect on-premises data center to GCP via Cloud VPN with shared VPC, private access, and centralized monitoring.',
    difficulty: 'Advanced',
    tags: ['networking', 'hybrid', 'vpn', 'vpc'],
    preview: { nodeCount: 8, connectionCount: 7 },
    nodes: [
      { id: 'n1', service: svc('vpc'), x: 360, y: 48 },
      { id: 'n2', service: svc('cloud-nat'), x: 168, y: 48 },
      { id: 'n3', service: svc('compute-engine'), x: 168, y: 216 },
      { id: 'n4', service: svc('gke'), x: 360, y: 216 },
      { id: 'n5', service: svc('cloud-sql'), x: 552, y: 216 },
      { id: 'n6', service: svc('cloud-dns'), x: 552, y: 48 },
      { id: 'n7', service: svc('cloud-monitoring'), x: 360, y: 408 },
      { id: 'n8', service: svc('iam'), x: 168, y: 408 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n3', label: 'subnet-a' },
      { id: 'c2', from: 'n1', to: 'n4', label: 'subnet-b' },
      { id: 'c3', from: 'n1', to: 'n5', label: 'subnet-c' },
      { id: 'c4', from: 'n2', to: 'n1', label: 'NAT gateway' },
      { id: 'c5', from: 'n6', to: 'n1', label: 'DNS resolution' },
      { id: 'c6', from: 'n3', to: 'n7', label: 'metrics' },
      { id: 'c7', from: 'n4', to: 'n7', label: 'metrics' },
    ],
    zones: [
      { id: 'z1', x: 120, y: 12, width: 520, height: 100, label: 'VPC Network Layer', color: '#ea4335' },
      { id: 'z2', x: 120, y: 176, width: 520, height: 100, label: 'Workloads (Private Subnets)', color: '#4285f4' },
      { id: 'z3', x: 120, y: 370, width: 520, height: 100, label: 'Operations & Security', color: '#fbbc04' },
    ],
    annotations: [
      { id: 'a1', x: 600, y: 340, text: 'Cloud VPN or Interconnect\nconnects on-prem network\nto this VPC' },
      { id: 'a2', x: 600, y: 420, text: 'Private Google Access\nlets private VMs reach\nGoogle APIs without\nexternal IPs' },
    ],
    learningNotes: [
      'Cloud VPN provides encrypted tunnels over the public internet. For higher bandwidth, use Cloud Interconnect.',
      'Cloud NAT lets private VMs access the internet without external IPs (outbound only).',
      'Use Shared VPC to centralize network management across multiple projects.',
      'Private Google Access allows VMs without external IPs to reach Google APIs and services.',
      'Cloud DNS supports private zones for split-horizon DNS between on-prem and cloud.',
      'Always use custom-mode VPCs in production — auto-mode creates subnets in every region.',
    ],
  },
  {
    id: 'ml-pipeline',
    name: 'ML Training & Serving Pipeline',
    description: 'End-to-end ML workflow with Vertex AI, BigQuery for features, Cloud Storage for artifacts, and Cloud Run for serving.',
    difficulty: 'Advanced',
    tags: ['machine-learning', 'vertex-ai', 'mlops', 'bigquery'],
    preview: { nodeCount: 7, connectionCount: 7 },
    nodes: [
      { id: 'n1', service: svc('bigquery'), x: 120, y: 120 },
      { id: 'n2', service: svc('cloud-storage'), x: 120, y: 312 },
      { id: 'n3', service: svc('vertex-ai'), x: 360, y: 216 },
      { id: 'n4', service: svc('artifact-registry'), x: 600, y: 120 },
      { id: 'n5', service: svc('cloud-run'), x: 600, y: 312 },
      { id: 'n6', service: svc('cloud-monitoring'), x: 840, y: 216 },
      { id: 'n7', service: svc('cloud-build'), x: 360, y: 408 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n3', label: 'training data' },
      { id: 'c2', from: 'n2', to: 'n3', label: 'feature store' },
      { id: 'c3', from: 'n3', to: 'n4', label: 'model artifact' },
      { id: 'c4', from: 'n4', to: 'n5', label: 'serve model' },
      { id: 'c5', from: 'n5', to: 'n6', label: 'prediction logs' },
      { id: 'c6', from: 'n6', to: 'n3', label: 'retrain trigger' },
      { id: 'c7', from: 'n7', to: 'n3', label: 'pipeline trigger' },
    ],
    zones: [
      { id: 'z1', x: 72, y: 80, width: 200, height: 300, label: 'Data Sources', color: '#9c27b0' },
      { id: 'z2', x: 300, y: 168, width: 200, height: 120, label: 'Training', color: '#ff6d00' },
      { id: 'z3', x: 540, y: 80, width: 200, height: 300, label: 'Deploy & Monitor', color: '#00bcd4' },
    ],
    annotations: [
      { id: 'a1', x: 360, y: 48, text: 'Vertex AI Pipelines\norchestrate the full\ntrain → evaluate → deploy\nworkflow' },
      { id: 'a2', x: 840, y: 340, text: 'Model drift detection\ntriggers automated\nretraining via Pub/Sub' },
    ],
    learningNotes: [
      'Vertex AI Pipelines (Kubeflow-based) automate the ML lifecycle end-to-end.',
      'Feature Store provides a centralized, versioned repository of ML features.',
      'Model Registry tracks model versions, metadata, and lineage for governance.',
      'Use preemptible VMs for training to reduce costs by up to 80%.',
      'Cloud Monitoring + custom metrics detect model drift and trigger retraining.',
      'Vertex AI Endpoints handle model serving with auto-scaling and A/B testing.',
    ],
  },
  {
    id: 'static-website',
    name: 'Global Static Website',
    description: 'Static site hosted on Cloud Storage with Cloud CDN, Cloud Load Balancing, HTTPS, and Cloud Armor protection.',
    difficulty: 'Beginner',
    tags: ['static', 'cdn', 'hosting', 'web'],
    preview: { nodeCount: 5, connectionCount: 4 },
    nodes: [
      { id: 'n1', service: svc('cloud-dns'), x: 312, y: 48 },
      { id: 'n2', service: svc('cloud-load-balancing'), x: 312, y: 192 },
      { id: 'n3', service: svc('cloud-cdn'), x: 120, y: 192 },
      { id: 'n4', service: svc('cloud-armor'), x: 504, y: 192 },
      { id: 'n5', service: svc('cloud-storage'), x: 312, y: 384 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n2', label: 'DNS' },
      { id: 'c2', from: 'n3', to: 'n2', label: 'cache hit' },
      { id: 'c3', from: 'n4', to: 'n2', label: 'WAF rules' },
      { id: 'c4', from: 'n2', to: 'n5', label: 'origin fetch' },
    ],
    zones: [
      { id: 'z1', x: 264, y: 24, width: 200, height: 80, label: 'DNS', color: '#ea4335' },
      { id: 'z2', x: 72, y: 152, width: 520, height: 100, label: 'Edge Network', color: '#ea4335' },
      { id: 'z3', x: 264, y: 344, width: 200, height: 100, label: 'Origin', color: '#34a853' },
    ],
    annotations: [
      { id: 'a1', x: 552, y: 300, text: 'GCS bucket with\nuniform bucket-level\naccess enabled' },
      { id: 'a2', x: 552, y: 384, text: 'Use versioned file names\n(app.v3.js) instead of\ncache invalidation' },
    ],
    learningNotes: [
      'Cloud Storage can serve static websites directly — enable the website configuration on the bucket.',
      'Cloud CDN requires an external HTTP(S) Load Balancer as the frontend.',
      'Cloud Armor adds DDoS protection and WAF rules (e.g., OWASP Top 10) at the edge.',
      'Use Cloud DNS to point your custom domain to the load balancer\'s IP.',
      'Set proper Cache-Control headers on objects to maximize CDN hit rate.',
    ],
  },
  {
    id: 'event-driven-processing',
    name: 'Event-Driven File Processing',
    description: 'Automated file processing triggered by Cloud Storage uploads via Eventarc, processed by Cloud Run, results stored in Firestore.',
    difficulty: 'Intermediate',
    tags: ['serverless', 'events', 'storage', 'processing'],
    preview: { nodeCount: 6, connectionCount: 5 },
    nodes: [
      { id: 'n1', service: svc('cloud-storage'), x: 120, y: 192 },
      { id: 'n2', service: svc('pub-sub'), x: 312, y: 192 },
      { id: 'n3', service: svc('cloud-run'), x: 504, y: 192 },
      { id: 'n4', service: svc('firestore'), x: 696, y: 120 },
      { id: 'n5', service: svc('cloud-storage'), x: 696, y: 312 },
      { id: 'n6', service: svc('cloud-monitoring'), x: 504, y: 384 },
    ],
    connections: [
      { id: 'c1', from: 'n1', to: 'n2', label: 'object.finalize' },
      { id: 'c2', from: 'n2', to: 'n3', label: 'push trigger' },
      { id: 'c3', from: 'n3', to: 'n4', label: 'metadata' },
      { id: 'c4', from: 'n3', to: 'n5', label: 'processed files' },
      { id: 'c5', from: 'n3', to: 'n6', label: 'logs + metrics' },
    ],
    zones: [
      { id: 'z1', x: 72, y: 152, width: 200, height: 100, label: 'Upload Bucket', color: '#34a853' },
      { id: 'z2', x: 264, y: 152, width: 320, height: 100, label: 'Event Processing', color: '#e91e63' },
      { id: 'z3', x: 648, y: 80, width: 200, height: 300, label: 'Output', color: '#34a853' },
    ],
    annotations: [
      { id: 'a1', x: 120, y: 72, text: 'Users upload files\n(images, PDFs, CSVs)\nto the input bucket' },
      { id: 'a2', x: 312, y: 72, text: 'Eventarc routes GCS\nevents through Pub/Sub\nto Cloud Run' },
    ],
    learningNotes: [
      'Eventarc uses Pub/Sub under the hood to route GCP audit log events to targets.',
      'Cloud Storage notifications trigger on object create, delete, archive, and metadata update.',
      'Cloud Run with push subscriptions is ideal — it auto-scales with event volume.',
      'Use separate buckets for input and output to avoid infinite processing loops.',
      'Idempotent processing is critical — Pub/Sub may deliver events more than once.',
    ],
  },
]
